<title>{{title}}</title>


<div class="container">
    <div class="alert alert-info" role="alert" *ngIf="indLoading"><img src="../../images/loading.gif" width="32" height="32" /> Loading...</div>
    <div *ngIf='tickets && tickets.length==0' class="alert alert-info" role="alert">No record found!</div>
    <div class='table-responsive' *ngIf="ticketId ==0">
        <table class="table table-striped table-bordered" *ngIf='tickets && tickets.length'>
            <thead>
                <tr>
                    <th>Ticket Id</th>
                    <th>Title</th>
                    <th>Created date</th>
                    <th>status</th>
                    <th>Priority</th>
                    <th>Created by</th>
                    <th> Application</th>
                    <th>Assigned To</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let tkt of tickets">
                    <td>
                        <a [routerLink]="['/Ticket']" [queryParams]="{ ticketId:tkt.TicketId  }">{{tkt.TicketId}}</a>
                    </td>
                    <td>{{tkt.Title}}</td>
                    <td>{{tkt.Createddate|date}}</td>
                    <td>{{tkt.status}}</td>
                    <td>{{tkt.PriorityDescription}}</td>
                    <td>{{tkt.createdby}}</td>
                    <td>{{tkt.ApplicationName}}</td>
                    <td>{{tkt.AssignedTo}}</td>
                </tr>
            </tbody>
        </table>
    </div>
    <div *ngIf="ticket">
        <div class="row">
            <div class="col-md-9">
                <h2>{{ticket.Title}}</h2>
            </div>
            <div class="col-md-3  top-buffer">
                <button title="Save" class="btn btn-primary" (click)="saveticket(ticket.TicketId)">Save</button>
                <a href="javascript:void(0)" (click)="goBack()" class="btn btn-info btn-md">
                    <span class="glyphicon glyphicon-chevron-left"></span> Back
                </a>
            </div>
        </div>
        <div class="container">
            <ul class="nav nav-tabs">
                <li class="active"><a data-toggle="tab" href="#home">Basic data</a></li>
                <li><a data-toggle="tab" href="#menu1">attachements</a></li>
                <li><a data-toggle="tab" href="#menu2">Audit</a></li>
            </ul>

            <div class="tab-content">
                <div id="home" class="tab-pane fade in active">
                    <div class="row top-buffer">
                        <div class="col-md-2"><label for="txtticketid">Ticket Id</label></div><div class="col-md-4"><input type="text" id="txtticketid" [(ngModel)]="ticket.TicketId" class="form-control" /> </div>
                        <div class="col-md-2"><label for="txttitile">Title</label></div><div class="col-md-4"><input type="text" id="txttitile" [(ngModel)]="ticket.Title" class="form-control" /> </div>
                    </div>
                    <div class="row top-buffer">
                        <div class="col-md-2"><label for="txtTDescription">Description</label></div><div class="col-md-10"><textarea rows="4" id="txtTDescription" [(ngModel)]="ticket.TDescription" class="form-control" style="min-width: 100%"></textarea> </div>
                    </div>
                    <div class="row top-buffer">
                        <div class="col-md-2"><label for="txtCreatedBy">Created By</label></div><div class="col-md-4">
                        <dropdown [selecId]="ticket.CreatedBy" [drpcollection]="users" ></dropdown>
                        </div>
                        <div class="col-md-2"><label for="txtStatusId">Status</label></div><div class="col-md-4">
                            <select id="txtStatusId" class="form-control" [(ngModel)]="ticket.StatusId">
                                <option *ngFor="let st of statuses" [value]="st.Id" selected="{{st.Id ==ticket.StatusId?true:null}}">{{st.keyValue}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="row top-buffer">
                        <div class="col-md-2"><label for="txtCreateddate">Created Date</label></div><div class="col-md-4"><input type="text" id="txtCreateddate" [ngModel]="ticket.Createddate|date" (ngModelChange)="item.value=$event" class="form-control" /> </div>
                        <div class="col-md-2"><label for="txtAssignedTo">Assigned to</label></div><div class="col-md-4">
                            <select id="txtAssignedTo" class="form-control" [(ngModel)]="ticket.AssignedTo">
                                <option *ngFor="let us of users" [value]="us.Id" [selected]="us.Id ==ticket.AssignedTo">{{us.keyValue}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="row top-buffer">
                        <div class="col-md-2"><label for="txtPriorityId">Priority</label></div><div class="col-md-4">
                            <select id="txtPriorityId" class="form-control" [(ngModel)]="ticket.PriorityId">
                                <option *ngFor="let pt of priorities" [value]="pt.Id" [selected]="pt.Id ==ticket.PriorityId">{{pt.keyValue}}</option>
                            </select>

                        </div>
                        <div class="col-md-2"><label for="txtTypeId">Ticket Type</label></div><div class="col-md-4">
                            <select id="txtPriorityId" class="form-control" [(ngModel)]="ticket.TypeId">
                                <option *ngFor="let tp of types" [value]="tp.Id" [selected]="tp.Id ==ticket.TypeId">{{tp.keyValue}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="row top-buffer">
                        <div class="col-md-2"><label for="txtApplicationId">Application</label></div><div class="col-md-4">

                            <select id="txtApplicationId" class="form-control" [(ngModel)]="ticket.ApplicationId">
                                <option *ngFor="let app of applications" [value]="app.Id" [selected]="app.Id ==ticket.ApplicationId">{{app.keyValue}}</option>
                            </select>
                        </div>
                        <div class="col-md-2"><label for="txtModuleID">Module</label></div><div class="col-md-4">

                            <select id="txtModuleID" class="form-control" [(ngModel)]="ticket.ModuleID">
                                <option *ngFor="let md of modules" [value]="md.Id" [selected]="md.Id ==ticket.ModuleID">{{md.keyValue}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="row top-buffer">
                        <div class="col-md-2"><label for="txtCoommnets">Comments</label></div><div class="col-md-10"><textarea rows="4" id="txtCoommnets" [(ngModel)]="ticket.Coommnets" class="form-control" style="min-width: 100%"></textarea> </div>
                    </div>
                </div>
                <div id="menu1" class="tab-pane fade">
                    <h3>attachements</h3>
                    <p>Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
                </div>
                <div id="menu2" class="tab-pane fade">
                    <h3>Audit Log</h3>
                    <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam.</p>
                </div>
            </div>
        </div>
    </div>
</div>
